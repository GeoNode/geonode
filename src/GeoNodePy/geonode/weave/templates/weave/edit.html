{% extends "fullscreen.html" %}
{% load i18n %}
{% load geonode_auth %}

{% block title %} "Weave" - {{ block.super }} {% endblock %}

{% block head %}
{% include "geonode/ext_header.html" %}
{{ block.super }}
{% has_obj_perm user visualization "weave.view_visualization" as can_copy %}
{% has_obj_perm user visualization "weave.change_visualization" as can_change %}
<script type="text/javascript" src="{{ STATIC_URL }}weave/app.js"></script>
<script type="text/javascript">
	var weaveReady = function(weave) {
		initWeave(weave);
		{% if user.is_authenticated %}initMetadataForm(
			weave,
			{
				"title": "{{ visualization.title }}",
				"abstract": "{{ visualization.abstract }}",
				"permissions": {
					"copy": {% if can_copy and visualization.id > 1 %}true{% else %}false{% endif %},
					"change": {% if can_change %}true{% else %}false{% endif %}
				}
			}
		);{% endif %}
	}
</script>

{% endblock %}

{% block body %}
<div id="header-wrapper">
  {{ block.super }}
  	<div id="topPanel">
		<div class="wrap">
		{% if user.is_authenticated %}<div id="save_visualization" class="visualization-button"></div><div id="embed_code" class="embed-button"></div>{% else %}<div class="visualization-button">Please sign in to save this Visualization.</div>{% endif %}
		<span id="visualization-title-header">{% if visualization.title %}{{ visualization.title }}{% else %}Your Visualization{% endif %}</span><span id="savemsg"></span>
		</div>
	</div>
</div>
<div id="weavediv">
{% include "weave/object.html" %}
</div>
{% endblock %}