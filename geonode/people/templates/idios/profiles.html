{% extends "idios/base.html" %}
{% load avatar_tags %}
{% load relationship_tags %}

{% block body_class %}profiles{% endblock %}

{% block main %}
<ul>
{% for profile in object_list %}
    {% if profile.user %}
        <li>
        {% avatar profile.user 50 %}<a href="{{ profile.get_absolute_url }}">{{ profile.name }}</a>
        {% if request.user != profile.user %}
            {# decide whether or not the current user is following this user #}
            {% if_relationship request.user profile.user "following" %}
                {# they are following them, so show a "remove" url #}
                <a href="{{ profile.user|remove_relationship_url:"following" }}">Unfollow</a>
            {% else %}
                {# they are not following them, so show a link to start following #}
                <a href="{{ profile.user|add_relationship_url:"following" }}">Follow</a>
            {% endif_relationship %}
        {% endif %}
        </li>
    {% endif %}
{% endfor %}
</ul>
{% endblock %}
