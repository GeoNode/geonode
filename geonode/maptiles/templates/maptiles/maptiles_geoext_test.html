{% include "geonode/ext_header.html" %}
{# {% include "geonode/app_header.html" %} #}
{#  {% include "maptiles/maptiles_header.html" %} #}
<script type="text/javascript" src="{{STATIC_URL}}lib/js/OpenLayers.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}lib/js/GeoExt.js"></script>
<script type="text/javascript" src="{{ STATIC_URL}}geonode/js/utils/thumbnail.js"></script>
<script type="text/javascript" >

{% autoescape off %}

var options = {{ viewer|safe }};
Ext.onReady(function (){
    
        var map_options = options["map"];
        var map = new OpenLayers.Map({
            center: map_options["center"],
            units: map_options["units"],
            maxResolution: map_options["maxResolution"],
            maxExtent: map_options["maxExtent"],
            //zoom: map_options["zoom"],
            //projection: map_options["projection"]
        
        });
        
        var mq_layer = new OpenLayers.Layer.XYZ(
            "OpenStreetMap",
            [
                "http://otile1.mqcdn.com/tiles/1.0.0/map/${z}/${x}/${y}.png",
                "http://otile2.mqcdn.com/tiles/1.0.0/map/${z}/${x}/${y}.png",
                "http://otile3.mqcdn.com/tiles/1.0.0/map/${z}/${x}/${y}.png",
                "http://otile4.mqcdn.com/tiles/1.0.0/map/${z}/${x}/${y}.png"
            ],
            {
                attribution: "Data, imagery and map information provided by <a href='http://www.mapquest.com/'  target='_blank'>MapQuest</a>, <a href='http://www.openstreetmap.org/' target='_blank'>Open Street Map</a> and contributors, <a href='http://creativecommons.org/licenses/by-sa/2.0/' target='_blank'>CC-BY-SA</a>  <img src='http://developer.mapquest.com/content/osm/mq_logo.png' border='0'>",
                transitionEffect: "resize"
            },
            {
                isBaseLayer: true
            }
        );
        
        var tile_layer = new OpenLayers.Layer.WMS("geonode:index",
            "http://cephgeo.lan.dream.upd.edu.ph:8080/geoserver/wms",
            {
                 layers: "geonode:index",
                 opacity:  0.7,
                 transparent: true
            },
            { isBaseLayer: false }
        );
        
        var items = [{
            xtype: "gx_zoomslider",
            aggressive: false,
            vertical: true,
            height: 100,
            x: 10,
            y: 20
        }];
        
        new GeoExt.MapPanel({
            renderTo: "preview_map",
            height: 400,
            map: map,
            title: "Test Map",
            items: items,
            layers: [
                mq_layer,
                tile_layer
            ]
        });
        
});
{% endautoescape %}
</script>
