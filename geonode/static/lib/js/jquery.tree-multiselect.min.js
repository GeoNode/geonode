/* jQuery Tree Multiselect v2.2.1 | (c) Patrick Tsai | MIT Licensed */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";c.createLookup=function(a){return{arr:a,children:{}}},c.createSection=function(a){return{type:"section",name:a,items:[]}},c.isSection=function(a){return a&&"section"===a.type},c.getSectionName=function(a){return a.name},c.getSectionItems=function(a){return a.items},c.createItem=function(a,b,c,d,e,f){return{type:"item",id:a,value:b,text:c,description:d,initialIndex:e,section:f}},c.isItem=function(a){return a&&"item"===a.type}},{}],2:[function(a,b,c){"use strict";function d(a){var b={allowBatchSelection:!0,collapsible:!0,enableSelectAll:!1,selectAllText:"Select All",unselectAllText:"Unselect All",freeze:!1,hideSidePanel:!1,onChange:null,onlyBatchSelection:!1,searchable:!1,searchParams:["value","text","description","section"],sectionDelimiter:"/",showSectionOnSelected:!0,sortable:!1,startCollapsed:!1};return jQuery.extend({},b,a)}var e=a("./tree"),f=0,g=function(a){var b=this,c=d(a);return this.each(function(){var a=b;a.attr("multiple","").css("display","none");var d=new e(f,a,c);d.initialize(),++f}),this};b.exports=g},{"./tree":5}],3:[function(a,b,c){"use strict";function d(a,b,c,d){this.options=a,this.index={},this.selectionNodeHash=b,this.selectionNodeHashKeys=Object.keys(b),this.sectionNodeHash=c,this.sectionNodeHashKeys=Object.keys(c),this.setSearchParams(d),this.buildIndex()}function e(a){if(f.assert(a),a.length<g)return[a];for(var b=[],c=0;c<a.length-g+1;++c)b.push(a.substring(c,c+g));return b}var f=a("./utility"),g=3;d.prototype.setSearchParams=function(a){f.assert(Array.isArray(a));var b={value:!0,text:!0,description:!0,section:!0};this.searchParams=[];for(var c=0;c<a.length;++c)b[a[c]]&&this.searchParams.push(a[c])},d.prototype.buildIndex=function(){var a=this;this.options.forEach(function(b){var c=[];a.searchParams.forEach(function(a){c.push(b[a])}),f.array.removeFalseyExceptZero(c);var d=c.map(function(a){return a.toLowerCase()});d.forEach(function(c){var d=c.split(" ");d.forEach(function(c){a._addToIndex(c,b.id)})})})},d.prototype._addToIndex=function(a,b){for(var c=1;c<=g;++c)for(var d=0;d<a.length-c+1;++d){var e=a.substring(d,d+c);this.index[e]||(this.index[e]=[]);var f=this.index[e].length;0!==f&&this.index[e][f-1]===b||this.index[e].push(b)}},d.prototype.search=function(a){var b=this;if(!a)return this.selectionNodeHashKeys.forEach(function(a){b.selectionNodeHash[a].style.display=""}),void this.sectionNodeHashKeys.forEach(function(a){b.sectionNodeHash[a].style.display="",b.sectionNodeHash[a].removeAttribute("searchhit")});a=a.toLowerCase();var c=a.split(" "),d=[];c.forEach(function(a){var c=e(a);c.forEach(function(a){d.push(b.index[a]||[])})});var g=f.array.intersectMany(d);this._handleNodeVisbilities(g)},d.prototype._handleNodeVisbilities=function(a){var b=this,c={},d={};a.forEach(function(a){c[a]=!0;var e=b.selectionNodeHash[a];for(e.style.display="",e=e.parentNode;!e.className.match(/tree-multiselect/);){if(e.className.match(/section/)){var g=f.getKey(e);if(f.assert(g||0===g),d[g])break;d[g]=!0,e.style.display="",e.setAttribute("searchhit",!0)}e=e.parentNode}}),this.selectionNodeHashKeys.forEach(function(a){c[a]||(b.selectionNodeHash[a].style.display="none")}),this.sectionNodeHashKeys.forEach(function(a){d[a]||(b.sectionNodeHash[a].style.display="none")})},b.exports=d},{"./utility":9}],4:[function(a,b,c){"use strict";!function(b){b.fn.treeMultiselect=a("./main")}(jQuery)},{"./main":2}],5:[function(a,b,c){"use strict";function d(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function e(a,b,c){this.id=a,this.$originalSelect=b,this.uiBuilder=new h(b,c.hideSidePanel),this.$selectionContainer=this.uiBuilder.$selectionContainer,this.$selectedContainer=this.uiBuilder.$selectedContainer,this.params=c,this.selectOptions=[],this.selectNodes={},this.sectionNodes={},this.selectedNodes={},this.selectedKeys=[],this.keysToAdd=[],this.keysToRemove=[]}var f=a("./ast"),g=a("./search"),h=a("./ui-builder"),i=a("./utility");e.prototype.initialize=function(){if(this.generateSelections(this.$selectionContainer[0]),this.popupDescriptionHover(),this.params.allowBatchSelection&&this.handleSectionCheckboxMarkings(),this.params.collapsible&&this.addCollapsibility(),this.params.searchable||this.params.enableSelectAll){var a=i.dom.createNode("div",{class:"auxiliary"});this.$selectionContainer.prepend(a,this.$selectionContainer.firstChild),this.params.searchable&&this.createSearchBar(a),this.params.enableSelectAll&&this.createSelectAllButtons(a)}this.armRemoveSelectedOnClick(),this.updateSelectedAndOnChange(),this.render(!0),this.uiBuilder.attach()},e.prototype.generateSelections=function(a){var b=this.$originalSelect.children("option"),c=this.createAst(b);this.generateHtml(c,a)},e.prototype.createAst=function(a){var b,c=[],d=f.createLookup(c),e=this,g=0,h=[];return a.each(function(){var a=this;a.setAttribute("data-key",g);var b=a.getAttribute("data-section"),c=a.value,i=a.text,j=a.getAttribute("data-description"),k=parseInt(a.getAttribute("data-index")),l=f.createItem(g,c,i,j,k,b);k?e.keysToAdd[k]=g:a.hasAttribute("selected")&&h.push(g),e.selectOptions[g]=l,++g;for(var m=d,n=b&&b.length>0?b.split(e.params.sectionDelimiter):[],o=0;o<n.length;++o){var p=n[o];if(m.children[p])m=m.children[p];else{var q=f.createSection(p);m.arr.push(q);var r=f.createLookup(q.items);m.children[p]=r,m=r}}m.arr.push(l)}),i.array.removeFalseyExceptZero(this.keysToAdd),(b=this.keysToAdd).push.apply(b,h),i.array.uniq(this.keysToAdd),c},e.prototype.generateHtml=function(a,b,c){c=c||0;for(var d=0,e=0;e<a.length;++e){var g=a[e];if(f.isSection(g)){var h=f.getSectionName(g),j=d+c,k=i.dom.createSection(h,j,this.params.onlyBatchSelection||this.params.allowBatchSelection,this.params.freeze);this.sectionNodes[j]=k,++d,b.appendChild(k),d+=this.generateHtml(f.getSectionItems(g),k,c+d)}else if(f.isItem(g)){var l=i.dom.createSelection(g,this.id,!this.params.onlyBatchSelection,this.params.freeze);this.selectNodes[g.id]=l,b.appendChild(l)}}return d},e.prototype.popupDescriptionHover=function(){this.$selectionContainer.on("mouseenter","div.item > span.description",function(){var a=jQuery(this).parent(),b=a.attr("data-description"),c=document.createElement("div");c.className="temp-description-popup",c.innerHTML=b,c.style.position="absolute",a.append(c)}),this.$selectionContainer.on("mouseleave","div.item > span.description",function(){var a=jQuery(this).parent();a.find("div.temp-description-popup").remove()})},e.prototype.handleSectionCheckboxMarkings=function(){var a=this;this.$selectionContainer.on("click","input.section[type=checkbox]",function(){var b=jQuery(this).closest("div.section"),c=b.find("div.item"),d=[];if(c.each(function(a,b){d.push(i.getKey(b))}),this.checked){var e;(e=a.keysToAdd).push.apply(e,d),i.array.uniq(a.keysToAdd)}else{var f;(f=a.keysToRemove).push.apply(f,d),i.array.uniq(a.keysToRemove)}a.render()})},e.prototype.redrawSectionCheckboxes=function(a){a=a||this.$selectionContainer;var b=3,c=this,d=a.find("> div.section");if(d.each(function(){var a=c.redrawSectionCheckboxes(jQuery(this));b&=a}),b)for(var e=a.find("> div.item > input[type=checkbox]"),f=0;f<e.length&&(b&=e[f].checked?-3:-2,0!=b);++f);var g=a.find("> div.title > input[type=checkbox]");return g.length&&(g=g[0],1&b?(g.checked=!0,g.indeterminate=!1):2&b?(g.checked=!1,g.indeterminate=!1):(g.checked=!1,g.indeterminate=!0)),b},e.prototype.addCollapsibility=function(){var a="div.title",b=this.$selectionContainer.find(a),c=i.dom.createNode("span",{class:"collapse-section"});b.prepend(c);var d="div.section",e=this.$selectionContainer.find(d);this.params.startCollapsed&&e.addClass("collapsed"),this.$selectionContainer.on("click",a,function(a){if("INPUT"!=a.target.nodeName){var b=jQuery(this).parent();b.toggleClass("collapsed"),a.stopPropagation()}})},e.prototype.createSearchBar=function(a){var b=new g(this.selectOptions,this.selectNodes,this.sectionNodes,this.params.searchParams),c=i.dom.createNode("input",{class:"search",placeholder:"Search..."});a.appendChild(c),this.$selectionContainer.on("input","input.search",function(){var a=this.value;b.search(a)})},e.prototype.createSelectAllButtons=function(a){var b=i.dom.createNode("span",{class:"select-all",text:this.params.selectAllText}),c=i.dom.createNode("span",{class:"unselect-all",text:this.params.unselectAllText}),e=i.dom.createNode("div",{class:"select-all-container"});e.appendChild(b),e.appendChild(c),a.appendChild(e);var f=this;this.$selectionContainer.on("click","span.select-all",function(){for(var a=0;a<f.selectOptions.length;++a)f.keysToAdd.push(a);i.array.uniq(f.keysToAdd),f.render()}),this.$selectionContainer.on("click","span.unselect-all",function(){var a;(a=f.keysToRemove).push.apply(a,d(f.selectedKeys)),i.array.uniq(f.keysToRemove),f.render()})},e.prototype.armRemoveSelectedOnClick=function(){var a=this;this.$selectedContainer.on("click","span.remove-selected",function(){var b=this.parentNode,c=i.getKey(b);a.keysToRemove.push(c),a.render()})},e.prototype.updateSelectedAndOnChange=function(){var a=this;if(this.$selectionContainer.on("click","input.option[type=checkbox]",function(){var b=this,c=b.parentNode,d=i.getKey(c);i.assert(d||0===d),b.checked?a.keysToAdd.push(d):a.keysToRemove.push(d),a.render()}),this.params.sortable&&!this.params.freeze){var b=null,c=null;this.$selectedContainer.sortable({start:function(a,c){b=c.item.index()},stop:function(d,e){c=e.item.index(),b!==c&&(i.array.moveEl(a.selectedKeys,b,c),a.render())}})}},e.prototype.render=function(a){var b,c=this;i.array.subtract(this.keysToAdd,this.selectedKeys),i.array.intersect(this.keysToRemove,this.selectedKeys);for(var e=0;e<this.keysToRemove.length;++e){var f=this.selectedNodes[this.keysToRemove[e]];f&&(f.parentNode.removeChild(f),this.selectedNodes[this.keysToRemove[e]]=null);var g=this.selectNodes[this.keysToRemove[e]];g.getElementsByTagName("INPUT")[0].checked=!1}i.array.subtract(this.selectedKeys,this.keysToRemove);for(var h=0;h<this.keysToAdd.length;++h){var j=this.keysToAdd[h],k=this.selectOptions[j];this.selectedKeys.push(j);var l=i.dom.createSelected(k,this.params.freeze,this.params.showSectionOnSelected);this.selectedNodes[k.id]=l,this.$selectedContainer.append(l),this.selectNodes[this.keysToAdd[h]].getElementsByTagName("INPUT")[0].checked=!0}(b=this.selectedKeys).push.apply(b,d(this.keysToAdd)),i.array.uniq(this.selectedKeys),this.redrawSectionCheckboxes();for(var m={},n={},o=0;o<this.selectedKeys.length;++o){var p=this.selectOptions[this.selectedKeys[o]].value;m[this.selectedKeys[o]]=!0,n[p]=o}var q=this.$originalSelect.find("option").toArray();if(q.sort(function(a,b){var c=n[a.value]||0,d=n[b.value]||0;return c-d}),this.$originalSelect.html(q),this.$originalSelect.find("option").each(function(a,b){m[i.getKey(b)]?this.selected=!0:this.selected=!1}),this.$originalSelect.change(),!a&&this.params.onChange){var r=this.selectedKeys.map(function(a){return c.selectOptions[a]}),s=this.keysToAdd.map(function(a){return c.selectOptions[a]}),t=this.keysToRemove.map(function(a){return c.selectOptions[a]});this.params.onChange(r,s,t)}this.keysToRemove=[],this.keysToAdd=[]},b.exports=e},{"./ast":1,"./search":3,"./ui-builder":6,"./utility":9}],6:[function(a,b,c){"use strict";function d(a,b){var c=jQuery('<div class="tree-multiselect"></div>'),d=jQuery('<div class="selections"></div>');b&&d.addClass("no-border"),c.append(d);var e=jQuery('<div class="selected"></div>');b||c.append(e),this.$el=a,this.$tree=c,this.$selectionContainer=d,this.$selectedContainer=e}d.prototype.attach=function(){this.$el.after(this.$tree)},b.exports=d},{}],7:[function(a,b,c){"use strict";function d(a,b){for(var c=0,d=0;d<a.length;++d)b(a[d])&&(a[c]=a[d],++c);a.length=c}c.uniq=function(a){var b={},c=function(a){var c=!b[a];return b[a]=!0,c};d(a,c)},c.removeFalseyExceptZero=function(a){var b=function(a){return a||0===a};d(a,b)},c.moveEl=function(a,b,c){var d=a[b];a.splice(b,1),a.splice(c,0,d)},c.subtract=function(a,b){for(var c={},e=0;e<b.length;++e)c[b[e]]=!0;var f=function(a){return!c[a]};d(a,f)},c.intersect=function(a,b){for(var c={},e=0;e<b.length;++e)c[b[e]]=!0;var f=function(a){return c[a]};d(a,f)},c.intersectMany=function(a){var b=[],c=[];a.forEach(function(a){b.push(0),c.push(a.length-1)});for(var d=[];b.length>0&&b[0]<=c[0];++b[0]){for(var e=!1,f=1;f<a.length;++f){for(;a[f][b[f]]<a[0][b[0]]&&b[f]<=c[f];)++b[f];if(b[f]>c[f]){e=!0;break}}if(e)break;for(var g=!0,h=1;h<a.length;++h)if(a[0][b[0]]!==a[h][b[h]]){g=!1;break}g&&d.push(a[0][b[0]])}return d}},{}],8:[function(a,b,c){"use strict";c.createNode=function(a,b){var c=document.createElement(a);if(b){for(var d in b)b.hasOwnProperty(d)&&"text"!==d&&c.setAttribute(d,b[d]);b.text&&(c.textContent=b.text)}return c},c.createSelection=function(a,b,d,e){var f={class:"item","data-key":a.id,"data-value":a.value},g=!!a.description;g&&(f["data-description"]=a.description),a.initialIndex&&(f["data-index"]=a.initialIndex);var h=c.createNode("div",f);if(g){var i=c.createNode("span",{class:"description",text:"?"});h.appendChild(i)}if(d){var j="treemultiselect-"+b+"-"+a.id,k={class:"option",type:"checkbox",id:j};e&&(k.disabled=!0);var l=c.createNode("input",k);h.insertBefore(l,h.firstChild);var m={for:j,text:a.text||a.value},n=c.createNode("label",m);h.appendChild(n)}else h.innerText=a.text||a.value;return h},c.createSelected=function(a,b,d){var e=c.createNode("div",{class:"item","data-key":a.id,"data-value":a.value,text:a.text});if(!b){var f=c.createNode("span",{class:"remove-selected",text:"×"});e.insertBefore(f,e.firstChild)}if(d){var g=c.createNode("span",{class:"section-name",text:a.section});e.appendChild(g)}return e},c.createSection=function(a,b,d,e){var f=c.createNode("div",{class:"section","data-key":b}),g=c.createNode("div",{class:"title",text:a});if(d){var h={class:"section",type:"checkbox"};e&&(h.disabled=!0);var i=c.createNode("input",h);g.insertBefore(i,g.firstChild)}return f.appendChild(g),f}},{}],9:[function(a,b,c){"use strict";c.array=a("./array"),c.assert=function(a,b){if(!a)throw new Error(b||"Assertion failed")},c.dom=a("./dom"),c.getKey=function(a){return c.assert(a),parseInt(a.getAttribute("data-key"))}},{"./array":7,"./dom":8}]},{},[4]);